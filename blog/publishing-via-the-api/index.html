



<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="description" content="For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let&amp;rsquo;s go over it.

Just want to use the Siteleaf gem? Skip to the ...">
  <meta property='st:title' content='Publishing via the API' />
  <meta name="twitter:widgets:link-color" content="#0091e5">

  
    <title>Publishing via the API</title>
  

  <link href="//cdn.symbolset.com/fe53f0eec3a73760941acb609672ebdd0840fda7/symbolset.css" rel="stylesheet">
  <link rel="stylesheet" href="/styles/css/style.css">
  <link rel="icon shortcut" href="/images/favicon.ico">
  
  <script type="text/javascript" src="//use.typekit.net/tti2qoh.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1666437-33', 'siteleaf.com');
    
    ga('send', 'pageview');
  </script>

  
    <a class="v2Teaser" href="http://v2.siteleaf.com">Weâ€™re working on great updates to Siteleaf &rarr;</a>
  
  <section class="layer main">
      <header>
        <h1 class="logo">
          <a href="/">Siteleaf</a>
        </h1>
        <span class="ss-rows main-nav-toggle right">Menu</span>
        <nav>
          <ul class="main-nav">
            
              
            
              
                <li class="main-nav-item">
                  <a href="/plans">Plans</a>
                </li>
              
            
              
                <li class="main-nav-item">
                  <a href="/blog">Blog</a>
                </li>
              
            
              
                <li class="main-nav-item">
                  <a href="/gallery">Gallery</a>
                </li>
              
            
              
                <li class="main-nav-item">
                  <a href="/themes">Themes</a>
                </li>
              
            
              
            
              
            
              
            
              
            
            <li class="main-nav-item">
              <a href="https://manage.siteleaf.com">Log in</a>
            </li>
            <li class="main-nav-item get-started-nav-item">
              <a href="https://manage.siteleaf.com/signup" class="get-started-btn">Sign up</a>
            </li>
          </ul>
        </nav>
      </header>

      
  </section>

  
  <section class="layer blog">
    
      
      <article>
  
  <h2 class="title">
    
      Publishing via the API
    
  </h2>
  <header class="blog-byline">
  
    <h6 class="blog-tag"><a href="/blog/tags/announcement">announcement</a></h6>
  
    <h6 class="blog-tag"><a href="/blog/tags/tutorial">tutorial</a></h6>
  
    <time datetime="2015-06-24">Jun 24, 2015</time>
     by Larry Fox
  </header>
  
    <p>For the last week publishing in the Siteleaf interface has been powered by our API. This has been a requested feature by some of our users and ourselves. Its behavior is bit different than some of our other API endpoints, so let&rsquo;s go over it.</p>

<p><em>Just want to use the Siteleaf gem? <a href="#jump-gem">Skip to the bottom!</a></em></p>

<p>To initiate a publish, make an authenticated <code>POST</code> request to the <code>/sites/:id/publish</code> endpoint.</p>

<pre><code class="bash">$ curl -u &quot;$API_KEY:$API_SECRET&quot; -X POST \
  http://api.siteleaf.com/v1/sites/$SITE_ID/publish

{&quot;job_id&quot;:&quot;e79af12c79ccd8866902d3dd&quot;} 
</code></pre>

<p>This triggers a publish and immediately returns a job ID (or returns an already running job ID if one exists). You can stop here if you&rsquo;d like and Siteleaf will happily chug away in the background. </p>

<p>But the fun doesn&rsquo;t stop there. You can optionally check in on publish progress using your <code>job_id</code> from above by making an authenticated <code>GET</code> request to the new <code>/jobs/:id</code> endpoint.</p>

<pre><code class="bash">$ curl -u &quot;$API_KEY:$API_SECRET&quot; \
  http://api.siteleaf.com/api/v1/jobs/e79af12c79ccd8866902d3dd

event:publish
data:{&quot;status&quot;:&quot;working&quot;,&quot;message&quot;:&quot;Checking... /home&quot;,&quot;updated_at&quot;:&quot;1435159120&quot;}

[etcâ€¦]

event:publish
data:{&quot;status&quot;:&quot;complete&quot;,&quot;message&quot;:&quot;Published&quot;,&quot;updated_at&quot;:&quot;1435159121&quot;}
</code></pre>

<p>This endpoint, unlike our others, consistently returns <a href="https://en.wikipedia.org/wiki/Server-sent_events">Server Sent Events</a> (SSE) instead of JSON documents (including  errors). The <code>data</code> field is JSON encoded however. SSE is supported in all modern browsers and there are client libraries in a number of programming languages. </p>

<p>Additionally, job ID&rsquo;s are kept for at least 30 minutes after completion so you can check in on a publish immediately or wait a bit.</p>

<p>Can&rsquo;t wait to see what uses you come up with!</p>

<p><a id="jump-gem"></a></p>

<h3>Publishing from the gem</h3>

<p>First install the latest gem (<a href="https://rubygems.org/gems/siteleaf"><code>0.9.23</code></a> as of writing)</p>

<pre><code class="bash">$ gem install siteleaf
</code></pre>

<p>And thenâ€¦</p>

<pre><code class="bash">$ siteleaf publish
Fetching inventory...
Compiling...
[etcâ€¦]
Published
=&gt; Publish completed.
</code></pre>

<p>Or if you don&rsquo;t care about progress, you can use either of the following:</p>

<pre><code class="bash">$ siteleaf publish -q
$ siteleaf publish --quiet

=&gt; Publish queued.
</code></pre>

<p>ðŸŽ‰ðŸŽ‰</p>

    <p class="back"><a href="/blog">&larr; Back to Blog</a></p>
  
</article>

    
  </section>


  <footer class="layer">
    <section>
      <nav>
        <ul class="footer-nav">
          <li class="footer-nav-item"><a href="/help">Help</a>
          <li class="footer-nav-item"><a href="/help/themes">Documentation</a>
          <li class="footer-nav-item"><a href="/">Features</a>
          <li class="footer-nav-item"><a href="/purpose">Purpose</a>
          <li class="footer-nav-item"><a href="/privacy">Privacy</a>
          <li class="footer-nav-item"><a href="/terms">Terms</a>
          <li class="footer-nav-item"><a href="https://github.com/siteleaf/siteleaf-api" target="_blank">API</a>
          <li class="footer-nav-item"><a href="http://status.siteleaf.com" target="_blank">Status</a>
        </ul>
      </nav>
      <small class="footer-copy">&copy;2016 Siteleafâ„¢ is made by <a href="http://oak.is">Oak</a>. Follow <a href="http://twitter.com/siteleaf">@siteleaf</a></small>
    </section>
  </footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
  <script src="/scripts/js/min/application.js"></script>
  
  <script src="/scripts/js/jquery.fitvids.js"></script>
  <script>
    $(document).ready(function(){
      $("section.blog").fitVids();
    });
  </script>

  <script src="//cdn.symbolset.com/fe53f0eec3a73760941acb609672ebdd0840fda7/symbolset.js"></script>
</body>
</html>